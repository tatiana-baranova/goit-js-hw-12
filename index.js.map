{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nexport default getImages;\n\nconst API_KEY = \"47418994-53b3f5e850acd57effb8c0e9d\";\nconst BASE_URL = 'https://pixabay.com/api/';\n\nasync function getImages(query, page = 1) {\n    try {\n        const { data } = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page,\n                per_page: 15,\n            }\n        });\n        // console.log(data);\n        \n        if (!data || !data.hits || data.hits.length === 0) {\n            throw new Error('No images found for the query');\n        }\n        \n        return data;\n    } catch (error) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n            position: 'topRight',\n        });\n        console.error(\"Error in getImages:\", error); \n        return null;\n    }\n}\n\n\n\n\n","export default reflectionImages;\nfunction reflectionImages(images) {\n    return images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n    <a class=\"gallery-item\" href=\"${largeImageURL}\">\n    <div class=\"gallery-image\">\n    <img class=\"image\" src=\"${webformatURL}\" alt=\"${tags}\">\n    <div>\n    <ul class=\"description\">\n    <li class=\"list-info\">\n    <h3 class=\"info-img\">Likes</h3>\n    <p class=\"text-img\">${likes}</p>\n    </li>\n    <li class=\"list-info\">\n    <h3 class=\"info-img\">Views</h3>\n    <p class=\"text-img\">${views}</p>\n    </li>\n    <li class=\"list-info\">\n    <h3 class=\"info-img\">Comments</h3>\n    <p class=\"text-img\">${comments}</p>\n    </li>\n    <li class=\"list-info\">\n    <h3 class=\"info-img\">Downloads</h3>\n    <p class=\"text-img\">${downloads}</p>\n    </li>\n    </ul>\n    </div>\n    </div>\n    </a>\n    `).join(\"\");\n    \n}","import axios from 'axios';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport \"./js/pixabay-api.js\";\nimport getImages from \"./js/pixabay-api.js\";\n\nimport \"./js/render-functions.js\";\nimport reflectionImages from \"./js/render-functions\";\n\n\nconst formSearch = document.querySelector(\".search-form\");\nconst gallery = document.querySelector(\".gallery\");\n// const input = document.querySelector(\".form-input\")\nconst loader = document.querySelector(\"#loader\");\nconst buttonLoad = document.querySelector(\"#load-more\")\n\nlet lightbox = new SimpleLightbox(\".gallery-item\", {\n    captions: true,\n    captionSelector: \"img\",\n    captionType: \"attr\",\n    captionsData: \"alt\",\n    captionDelay: 250,\n});\n\nconst showLoader = () => {\n    loader.classList.replace(\"hidden\", \"loader\");\n    console.log(\"Loader shown - current class:\", loader.className);\n}\nconst hiddenLoader = () => {\n    loader.classList.replace(\"loader\", \"hidden\");\n    console.log(\"Loader hidden\")\n};\nconst showMore = () => buttonLoad.classList.replace(\"hidden\", \"load-more\");\nconst hiddenMore = () => buttonLoad.classList.replace(\"load-more\", \"hidden\");\n\nlet currentPage = 1;\nconst perPage = 15;\nlet searchQuery = \"\";\nlet totalHits = 0;\n\nconst updateLoadMoreButton = () => {\n    if (currentPage * perPage >= totalHits) {\n        hiddenMore();\n        iziToast.info({\n                title: \"End results\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\",\n            });\n    } else {\n        showMore();\n    }\n};\n\n\nformSearch.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n    const query = event.target.elements.searchQuery.value.trim();\n    if (!query) {\n        iziToast.error({\n            title: \"Error\",\n            message: \"Please enter a search query!\",\n            position: \"topRight\",\n        });\n            event.target.reset();\n        return;\n    }\n\n    searchQuery = query;\n    currentPage = 1\n    gallery.innerHTML = \"\";\n    hiddenMore();\n    showLoader();\n\n    try {\n        const data = await getImages(searchQuery, currentPage);\n        hiddenLoader();\n        if (!data || !data.hits || data.hits.length === 0) {\n            iziToast.info({\n                title: \"No results\",\n                message: \"Sorry, no images found!\",\n                position: \"topRight\",\n            });\n            event.target.reset();\n            return;\n        }\n        totalHits = data.totalHits || 0;\n        const markup = reflectionImages(data.hits);\n            gallery.insertAdjacentHTML(\"beforeend\", markup);\n            lightbox.refresh();\n        \n        hiddenLoader();\n        updateLoadMoreButton();\n        // totalHits = data.totalHits;\n        // console.log(totalHits);\n        \n        event.target.reset();\n    }\n    catch (error) {\n        hiddenLoader();\n        console.error(\"Error during image fetch:\", error);\n        iziToast.error({\n            title: \"Error\",\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n            position: 'topRight',\n        });\n        event.target.reset();\n    }\n\n});\n\nbuttonLoad.addEventListener(\"click\", async () => {\n    hiddenMore();\n    showLoader();\n    currentPage += 1;\n    buttonLoad.disabled = true;\n    \n    \n    try {\n        const data = await getImages(searchQuery, currentPage);\n        hiddenLoader();\n        buttonLoad.disabled = false;\n        showMore();\n        if (!data || !data.hits || data.hits.length === 0) {\n            hiddenMore(); \n            iziToast.info({\n                title: \"End results\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\",\n            });\n            return;\n        }\n\n        const markup = reflectionImages(data.hits);\n        gallery.insertAdjacentHTML(\"beforeend\", markup);\n        lightbox.refresh();\n        // hiddenLoader();\n        updateLoadMoreButton();\n\n        const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\",\n        });\n    } catch (error) {\n        hiddenLoader();\n        hiddenMore();\n        buttonLoad.disabled = false;\n        console.error(\"Error during loading more images:\", error);\n        iziToast.error({\n            title: \"Error\",\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n            position: \"topRight\",\n        });\n    }\n});\n\n"],"names":["API_KEY","BASE_URL","getImages","query","page","data","axios","error","iziToast","reflectionImages","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","formSearch","gallery","loader","buttonLoad","lightbox","SimpleLightbox","showLoader","hiddenLoader","showMore","hiddenMore","currentPage","perPage","searchQuery","totalHits","updateLoadMoreButton","event","markup","cardHeight"],"mappings":"+vBAMA,MAAMA,EAAU,qCACVC,EAAW,2BAEjB,eAAeC,EAAUC,EAAOC,EAAO,EAAG,CACtC,GAAI,CACA,KAAM,CAAE,KAAAC,CAAM,EAAG,MAAMC,EAAM,IAAIL,EAAU,CACvC,OAAQ,CACJ,IAAKD,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAU,EACb,CACb,CAAS,EAGD,GAAI,CAACC,GAAQ,CAACA,EAAK,MAAQA,EAAK,KAAK,SAAW,EAC5C,MAAM,IAAI,MAAM,+BAA+B,EAGnD,OAAOA,CACV,OAAQE,EAAO,CACZ,OAAAC,EAAS,MAAM,CACX,MAAO,QACP,QAAS,2EACT,SAAU,UACtB,CAAS,EACD,QAAQ,MAAM,sBAAuBD,CAAK,EACnC,IACV,CACL,CCrCA,SAASE,EAAiBC,EAAQ,CAC9B,OAAOA,EAAO,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAAK;AAAA,oCAChEL,CAAa;AAAA;AAAA,8BAEnBD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,0BAK9BC,CAAK;AAAA;AAAA;AAAA;AAAA,0BAILC,CAAK;AAAA;AAAA;AAAA;AAAA,0BAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,0BAIRC,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAM9B,EAAE,KAAK,EAAE,CAEd,CCjBA,MAAMC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAU,SAAS,cAAc,UAAU,EAE3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAa,SAAS,cAAc,YAAY,EAEtD,IAAIC,EAAW,IAAIC,EAAe,gBAAiB,CAC/C,SAAU,GACV,gBAAiB,MACjB,YAAa,OACb,aAAc,MACd,aAAc,GAClB,CAAC,EAED,MAAMC,EAAa,IAAM,CACrBJ,EAAO,UAAU,QAAQ,SAAU,QAAQ,EAC3C,QAAQ,IAAI,gCAAiCA,EAAO,SAAS,CACjE,EACMK,EAAe,IAAM,CACvBL,EAAO,UAAU,QAAQ,SAAU,QAAQ,EAC3C,QAAQ,IAAI,eAAe,CAC/B,EACMM,EAAW,IAAML,EAAW,UAAU,QAAQ,SAAU,WAAW,EACnEM,EAAa,IAAMN,EAAW,UAAU,QAAQ,YAAa,QAAQ,EAE3E,IAAIO,EAAc,EAClB,MAAMC,EAAU,GAChB,IAAIC,EAAc,GACdC,EAAY,EAEhB,MAAMC,EAAuB,IAAM,CAC3BJ,EAAcC,GAAWE,GACzBJ,IACAnB,EAAS,KAAK,CACN,MAAO,cACP,QAAS,6DACT,SAAU,UAC1B,CAAa,GAELkB,GAER,EAGAR,EAAW,iBAAiB,SAAU,MAAOe,GAAU,CACnDA,EAAM,eAAc,EACpB,MAAM9B,EAAQ8B,EAAM,OAAO,SAAS,YAAY,MAAM,OACtD,GAAI,CAAC9B,EAAO,CACRK,EAAS,MAAM,CACX,MAAO,QACP,QAAS,+BACT,SAAU,UACtB,CAAS,EACGyB,EAAM,OAAO,QACjB,MACH,CAEDH,EAAc3B,EACdyB,EAAc,EACdT,EAAQ,UAAY,GACpBQ,IACAH,IAEA,GAAI,CACA,MAAMnB,EAAO,MAAMH,EAAU4B,EAAaF,CAAW,EAErD,GADAH,IACI,CAACpB,GAAQ,CAACA,EAAK,MAAQA,EAAK,KAAK,SAAW,EAAG,CAC/CG,EAAS,KAAK,CACV,MAAO,aACP,QAAS,0BACT,SAAU,UAC1B,CAAa,EACDyB,EAAM,OAAO,QACb,MACH,CACDF,EAAY1B,EAAK,WAAa,EAC9B,MAAM6B,EAASzB,EAAiBJ,EAAK,IAAI,EACrCc,EAAQ,mBAAmB,YAAae,CAAM,EAC9CZ,EAAS,QAAO,EAEpBG,IACAO,IAIAC,EAAM,OAAO,OAChB,OACM1B,EAAO,CACVkB,IACA,QAAQ,MAAM,4BAA6BlB,CAAK,EAChDC,EAAS,MAAM,CACX,MAAO,QACP,QAAS,2EACT,SAAU,UACtB,CAAS,EACDyB,EAAM,OAAO,OAChB,CAEL,CAAC,EAEDZ,EAAW,iBAAiB,QAAS,SAAY,CAC7CM,IACAH,IACAI,GAAe,EACfP,EAAW,SAAW,GAGtB,GAAI,CACA,MAAMhB,EAAO,MAAMH,EAAU4B,EAAaF,CAAW,EAIrD,GAHAH,IACAJ,EAAW,SAAW,GACtBK,IACI,CAACrB,GAAQ,CAACA,EAAK,MAAQA,EAAK,KAAK,SAAW,EAAG,CAC/CsB,IACAnB,EAAS,KAAK,CACV,MAAO,cACP,QAAS,6DACT,SAAU,UAC1B,CAAa,EACD,MACH,CAED,MAAM0B,EAASzB,EAAiBJ,EAAK,IAAI,EACzCc,EAAQ,mBAAmB,YAAae,CAAM,EAC9CZ,EAAS,QAAO,EAEhBU,IAEA,KAAM,CAAE,OAAQG,CAAU,EAAKhB,EAAQ,kBAAkB,wBACzD,OAAO,SAAS,CACZ,IAAKgB,EAAa,EAClB,SAAU,QACtB,CAAS,CACJ,OAAQ5B,EAAO,CACZkB,IACAE,IACAN,EAAW,SAAW,GACtB,QAAQ,MAAM,oCAAqCd,CAAK,EACxDC,EAAS,MAAM,CACX,MAAO,QACP,QAAS,2EACT,SAAU,UACtB,CAAS,CACJ,CACL,CAAC"}